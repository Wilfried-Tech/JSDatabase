{"version":3,"file":"JSDatabase.js","mappings":"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","sources":["webpack://DatabaseJS/./src/common/constants.ts","webpack://DatabaseJS/./src/common/enums.ts","webpack://DatabaseJS/./src/common/index.ts","webpack://DatabaseJS/./src/common/interfaces.ts","webpack://DatabaseJS/./src/executors/query_manager.ts","webpack://DatabaseJS/./src/main/database.ts","webpack://DatabaseJS/./src/main/database_helper.ts","webpack://DatabaseJS/./src/main/index.ts","webpack://DatabaseJS/./src/main/logger.ts","webpack://DatabaseJS/./src/utils/index.ts","webpack://DatabaseJS/./src/utils/is_db_support.ts","webpack://DatabaseJS/./src/utils/promise.ts","webpack://DatabaseJS/webpack/bootstrap","webpack://DatabaseJS/webpack/runtime/define property getters","webpack://DatabaseJS/webpack/runtime/hasOwnProperty shorthand","webpack://DatabaseJS/webpack/runtime/make namespace object","webpack://DatabaseJS/./src/index.ts"],"sourcesContent":["import {fullSupportDatabases} from \"@src/utils\"\n\nexport const IDB_SUPPORT = fullSupportDatabases()\nexport const IS_WORKER = typeof (self as any).alert === \"undefined\"\n","export enum DataType {\n  Number = \"number\",\n    String = \"string\",\n    Boolean = \"boolean\",\n    Date = \"date\",\n    Object = \"object\",\n    Array = \"array\",\n    JSON = \"json\"\n}\n\nexport enum ERROR {\n  IDB_UNSUPPORTED = \"idb_not_supported\"\n}\n","export * from './constants'\nexport * from './interfaces'\nexport * from './types'\nexport * from './enums'\n","import { ERROR } from './enums'\n\nexport interface IError {\n  type: ERROR;\n  message: string;\n}\n\nexport interface ISelect{\n  distinct?: boolean;\n  columns:Array<string>|string;\n  fr\n}","import { QueryRequest, QueryResult } from '@src/common'\n\nexport default class QueryManager {\n  \n  private processFinishedCallback: Function;\n  \n  constructor(processFinishedCallback?: Function) {\n    this.processFinishedCallback = (processFinishedCallback)? processFinishedCallback : (res:QueryResult)=>{\n      (self as any).postMessage(res);\n    }\n  }\n  \n  public execute(req: QueryRequest){\n    this.processFinishedCallback(\"test okay\")\n  }\n}","import DatabaseHelper from './database_helper'\n\nexport class Database extends DatabaseHelper {\n\n  constructor(worker ? : Worker) {\n    super(worker);\n  }\n  \n  \n  \n  openOrCreateDatabase(dbname: string){\n    return;\n  }\n  \n}\n","import { QueryResult, QueryRequest, IS_WORKER, IDB_SUPPORT } from '@src/common'\nimport QueryManager from '@src/executors/query_manager'\n\nexport default class DatabaseHelper {\n\n  private isworker = true;\n  private _worker: Worker;\n  private queryManager: QueryManager\n  private requestQueue: Array < QueryRequest > = [];\n  private isCodeExecuting = false;\n\n  constructor(worker ? : Worker) {\n    if (worker) {\n      this._worker = worker;\n      this._worker.onmessage = this.processFinished.bind(this);\n    } else {\n      this.queryManager = new QueryManager(this.onResponse.bind(this));\n      this.isworker = false;\n    }\n  }\n\n  private processFinished(response: any) {\n    this.onResponse(response.data);\n  }\n\n  private onResponse(response: QueryResult) {\n\n    this.proceedRequest();\n  }\n\n  private addQuery < T > (query: QueryRequest) {\n    return new Promise<T>((resolve, reject) => {\n      this.requestQueue.push(query);\n      this.proceedRequest();\n    })\n  }\n\n  private proceedRequest() {\n    if (!this.isCodeExecuting) {\n      if (this.requestQueue.length != 0) {\n        this.postRequest(this.requestQueue.shift() as QueryRequest);\n      }\n    }\n  }\n\n  private postRequest(query: QueryRequest) {\n    if (IS_WORKER) {\n      this._worker.postMessage(query);\n    } else {\n      this.queryManager.execute(query);\n    }\n  }\n}\n","export * from './database'\nexport * from './logger'\n","import { ERROR, IError } from '@src/common'\n\n\nexport class Logger implements IError {\n\n  type: ERROR\n  message: string\n  \n  private info;\n  \n  constructor(type: ERROR, info ? ) {\n    this.info = info;\n  }\n  \n  throw(){\n    throw this.get();\n  }\n  \n  get(){\n    return {\n      type: this.type,\n      message: this.getMsg()\n    } as IError;\n  }\n  \n  private getMsg() {\n\n    switch (this.type) {\n      case ERROR.IDB_UNSUPPORTED:\n        return \"Your Browser does not support IndexedDB\"\n    }\n  }\n}\n","/**\n * merge two or more object\n * @param {Array<Object>} args\n * @return {Object}\n */\nexport function merge(args) {\n  if (args.length) {\n    var obj = {};\n    for (var i = 0; i < args.length; i++) {\n      Object.keys(args[i]).forEach(key => {\n        obj[key] = args[i][key]\n      })\n    }\n    return obj\n  }\n}\n\n/**\n * return the type of his parameter\n * @param {*} arg variable\n * @returns {String} \n */\nexport function type(arg): string {\n  var s = Object.prototype.toString.call(arg);\n  /\\[object (\\w+)\\]/i.exec(s);\n  return RegExp.$1.replace(/HTML|Element/g, '').toLowerCase();\n}\n\nexport * from './promise'\nexport * from './is_db_support'\n","/**\n * Check if indexedDB can run on this browser\n * @returns { Boolean }\n */\n\nexport function fullSupportDatabases() {\n  try {\n    if (!indexedDB) {\n      indexedDB = (self as any).mozIndexedDB || (self as any).webkitIndexedDB || (self as any).msIndexedDB;\n    }\n    if (indexedDB) {\n      IDBTransaction = IDBTransaction || (self as any).webkitIDBTransaction || (self as any).msIDBTransaction;\n      (self as any).IDBKeyRange = (self as any).IDBKeyRange || (self as any).webkitIDBKeyRange || (self as any).msIDBKeyRange;\n    }\n    else {\n      return false;\n    }\n  } catch (ex) {\n    return false;\n  }\n  return true;\n}\n","/**\n * resolve a promise\n * @param {Object} response value to resolve\n * @returns {Promise<Object>}\n */\n\nexport function resolve(response: any) {\n  return new Promise((_resolve) => { _resolve(response) })\n}\n\n/**\n * reject a promise\n * @param {Object} reason value to resolve\n * @returns {Promise<void>}\n */\n\nexport function reject(reason: any) {\n  return new Promise((_reject) => { _reject(reason) })\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Database, Logger } from './main'\nimport QueryManager from './executors/query_manager'\nimport { IS_WORKER, IDB_SUPPORT, QueryRequest, ERROR } from './common'\n\nvar workerUrl: string;\n\nif (IS_WORKER) {\n  (self as any).onmessage = function(data: QueryRequest) {\n    new QueryManager().execute(data);\n  }\n} else {\n  workerUrl = (document as any).currentScript.getAttribute('src');\n}\n\nexport function Connection() {\n  if (IDB_SUPPORT) {\n    return new Database(new Worker(workerUrl));\n  } else {\n    new Logger(ERROR.IDB_UNSUPPORTED).throw();\n  }\n}"],"names":[],"sourceRoot":""}